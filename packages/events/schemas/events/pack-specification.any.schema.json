{
  "title": "pack-specification.* Event",
  "description": "Generic event schema for pack specification changes",
  "type": "object",
  "properties": {
    "specversion": {
      "title": "CloudEvents spec version",
      "description": "CloudEvents specification version (fixed to 1.0).",
      "examples": [
        "1.0"
      ],
      "type": "string",
      "enum": [
        "1.0"
      ]
    },
    "id": {
      "title": "Event ID",
      "description": "Unique identifier for this event instance (UUID).",
      "examples": [
        "6f1c2a53-3d54-4a0a-9a0b-0e9ae2d4c111"
      ],
      "type": "string",
      "minLength": 1,
      "format": "uuid",
      "pattern": "^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$"
    },
    "type": {
      "title": "pack-specification event type",
      "description": "Event type using reverse-DNS style",
      "examples": [
        "uk.nhs.notify.supplier-config.pack-specification.published.v1",
        "uk.nhs.notify.supplier-config.pack-specification.disabled.v1"
      ],
      "type": "string",
      "enum": [
        "uk.nhs.notify.supplier-config.pack-specification.published.v1",
        "uk.nhs.notify.supplier-config.pack-specification.disabled.v1"
      ]
    },
    "dataschema": {
      "title": "Data Schema URI",
      "description": "URI of a schema that describes the event data\n\nData schema version must match the major version indicated by the type",
      "examples": [
        "https://notify.nhs.uk/cloudevents/schemas/supplier-config/pack-specification.published.1.0.0.schema.json",
        "https://notify.nhs.uk/cloudevents/schemas/supplier-config/pack-specification.disabled.1.0.0.schema.json"
      ],
      "type": "string",
      "pattern": "^https:\\/\\/notify\\.nhs\\.uk\\/cloudevents\\/schemas\\/supplier-config\\/pack-specification\\.(?<status>published|disabled)\\.1\\.\\d+\\.\\d+\\.schema.json$"
    },
    "dataschemaversion": {
      "title": "Data Schema Version",
      "description": "Matches semantic versioning format with fixed major version (Not part of cloudevents spec?)",
      "type": "string",
      "pattern": "^1\\.\\d+\\.\\d+$"
    },
    "source": {
      "title": "Event Source",
      "description": "Logical event producer path within the supplier-config domain",
      "type": "string",
      "pattern": "^\\/control-plane\\/supplier-config(?:\\/.*)?$"
    },
    "subject": {
      "title": "Event Subject",
      "description": "Resource path (no leading slash) within the source made of segments separated by '/'.",
      "examples": [
        "supplier-config/pack-specification/f47ac10b-58cc-4372-a567-0e02b2c3d479"
      ],
      "type": "string",
      "pattern": "\\/supplier-config\\/pack-specification\\/[a-z0-9-]+$"
    },
    "data": {
      "title": "PackSpecification",
      "description": "A PackSpecification defines the composition, postage and assembly attributes for producing a pack.",
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "status": {
          "type": "string",
          "enum": [
            "DRAFT",
            "PUBLISHED",
            "DISABLED"
          ]
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "pattern": "^(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))T(?:(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?(?:Z))$"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "pattern": "^(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))T(?:(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?(?:Z))$"
        },
        "version": {
          "type": "integer",
          "minimum": -9007199254740991,
          "maximum": 9007199254740991
        },
        "billingId": {
          "type": "string"
        },
        "constraints": {
          "type": "object",
          "properties": {
            "maxSheets": {
              "type": "number"
            },
            "deliverySLA": {
              "type": "number"
            },
            "blackCoveragePercentage": {
              "type": "number"
            },
            "colourCoveragePercentage": {
              "type": "number"
            }
          }
        },
        "postage": {
          "description": "Postage",
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "size": {
              "type": "string",
              "enum": [
                "STANDARD",
                "LARGE"
              ]
            },
            "deliverySLA": {
              "type": "number"
            },
            "maxWeight": {
              "type": "number"
            },
            "maxThickness": {
              "type": "number"
            }
          },
          "required": [
            "id",
            "size"
          ]
        },
        "assembly": {
          "type": "object",
          "properties": {
            "envelopeId": {
              "title": "Envelope ID Reference",
              "description": "Reference to a Envelope by its unique identifier",
              "type": "string"
            },
            "printColour": {
              "type": "string",
              "enum": [
                "BLACK",
                "COLOUR"
              ]
            },
            "paper": {
              "description": "Paper",
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                },
                "weightGSM": {
                  "type": "number"
                },
                "size": {
                  "type": "string",
                  "enum": [
                    "A4",
                    "A3"
                  ]
                },
                "colour": {
                  "type": "string",
                  "enum": [
                    "WHITE",
                    "COLOURED"
                  ]
                },
                "recycled": {
                  "type": "boolean"
                }
              },
              "required": [
                "id",
                "name",
                "weightGSM",
                "size",
                "colour",
                "recycled"
              ]
            },
            "insertIds": {
              "type": "array",
              "items": {
                "title": "Insert ID Reference",
                "description": "Reference to a Insert by its unique identifier",
                "type": "string"
              }
            },
            "features": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "MAILMARK",
                  "BRAILLE",
                  "AUDIO",
                  "ADMAIL"
                ]
              }
            },
            "additional": {
              "type": "object",
              "additionalProperties": {
                "type": "string"
              }
            }
          }
        }
      },
      "required": [
        "id",
        "name",
        "status",
        "createdAt",
        "updatedAt",
        "version",
        "postage"
      ]
    },
    "time": {
      "title": "Event Time",
      "description": "Timestamp when the event occurred (RFC 3339).",
      "examples": [
        "2025-10-01T10:15:30.000Z"
      ],
      "type": "string",
      "format": "date-time",
      "pattern": "^(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))T(?:(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?(?:Z))$"
    },
    "datacontenttype": {
      "title": "Data Content Type",
      "description": "Media type for the data field (fixed to application/json).",
      "examples": [
        "application/json"
      ],
      "type": "string",
      "enum": [
        "application/json"
      ]
    },
    "traceparent": {
      "title": "Traceparent",
      "description": "W3C Trace Context traceparent header value.",
      "examples": [
        "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"
      ],
      "type": "string",
      "minLength": 1,
      "pattern": "^00-[0-9a-f]{32}-[0-9a-f]{16}-[0-9a-f]{2}$"
    },
    "tracestate": {
      "title": "Tracestate",
      "description": "Optional W3C Trace Context tracestate header value.",
      "examples": [
        "rojo=00f067aa0ba902b7,congo=t61rcWkgMzE"
      ],
      "type": "string"
    },
    "partitionkey": {
      "title": "Partition Key",
      "description": "Partition / ordering key (lowercase alphanumerics and hyphen, 1-64 chars).",
      "examples": [
        "customer-920fca11"
      ],
      "type": "string",
      "minLength": 1,
      "maxLength": 64,
      "pattern": "^[a-z0-9-]+$"
    },
    "recordedtime": {
      "title": "Recorded Time",
      "description": "Timestamp when the event was recorded/persisted (should be >= time).",
      "examples": [
        "2025-10-01T10:15:30.250Z"
      ],
      "type": "string",
      "format": "date-time",
      "pattern": "^(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))T(?:(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?(?:Z))$"
    },
    "sampledrate": {
      "title": "Sampled Rate",
      "description": "Sampling factor: number of similar occurrences this event represents.",
      "examples": [
        5
      ],
      "type": "integer",
      "minimum": 1,
      "maximum": 9007199254740991
    },
    "sequence": {
      "title": "Sequence",
      "description": "Zero-padded 20 digit numeric sequence (lexicographically sortable).",
      "examples": [
        "00000000000000000042"
      ],
      "type": "string",
      "pattern": "^\\d{20}$"
    },
    "severitytext": {
      "title": "Severity Text",
      "description": "Log severity level name.",
      "examples": [
        "DEBUG"
      ],
      "type": "string",
      "enum": [
        "TRACE",
        "DEBUG",
        "INFO",
        "WARN",
        "ERROR",
        "FATAL"
      ]
    },
    "severitynumber": {
      "title": "Severity Number",
      "description": "Numeric severity (TRACE=0, DEBUG=1, INFO=2, WARN=3, ERROR=4, FATAL=5).",
      "examples": [
        1
      ],
      "type": "integer",
      "minimum": 0,
      "maximum": 5
    },
    "dataclassification": {
      "title": "Data Classification",
      "description": "Data sensitivity classification.",
      "examples": [
        "restricted"
      ],
      "type": "string",
      "enum": [
        "public",
        "internal",
        "confidential",
        "restricted"
      ]
    },
    "dataregulation": {
      "title": "Data Regulation",
      "description": "Regulatory regime tag applied to this data.",
      "examples": [
        "ISO-27001"
      ],
      "type": "string",
      "enum": [
        "GDPR",
        "HIPAA",
        "PCI-DSS",
        "ISO-27001",
        "NIST-800-53",
        "CCPA"
      ]
    },
    "datacategory": {
      "title": "Data Category",
      "description": "Data category classification (e.g. standard, special-category).",
      "examples": [
        "sensitive"
      ],
      "type": "string",
      "enum": [
        "non-sensitive",
        "standard",
        "sensitive",
        "special-category"
      ]
    }
  },
  "required": [
    "specversion",
    "id",
    "type",
    "dataschema",
    "dataschemaversion",
    "source",
    "subject",
    "data",
    "time",
    "traceparent",
    "recordedtime",
    "severitynumber"
  ]
}